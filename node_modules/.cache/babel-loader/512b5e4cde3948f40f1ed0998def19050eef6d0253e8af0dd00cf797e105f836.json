{"ast":null,"code":"import { ref, onMounted } from 'vue';\nimport { useProductStore } from '@/store/product.js';\nimport { useCartStore } from '@/store/cart.js';\nexport default {\n  setup() {\n    const productStore = useProductStore();\n    const cartStore = useCartStore();\n    const selectedQuantities = ref({});\n    function addToCart(product, quantity) {\n      cartStore.addToCart(product.product_id, quantity);\n      console.log('Cart after adding product: ', cartStore.cart);\n      selectedQuantities.value[product.product_id] = 1; // カートに追加した後に初期値を設定\n    }\n\n    function availableQuantity(product) {\n      const productInCart = cartStore.cart.find(item => item.product_id === product.product_id);\n      const quantityInCart = productInCart ? productInCart.selectedQuantity : 0; // selectedQuantity を使用する\n      return Array.from({\n        length: product.stock - quantityInCart\n      }, (_, i) => i + 1);\n    }\n    function getQuantityInCart(productId) {\n      const productInCart = cartStore.cart.find(item => item.product_id === productId);\n      return productInCart ? productInCart.selectedQuantity : 0;\n    }\n    onMounted(async () => {\n      await productStore.fetchProducts();\n      productStore.products.forEach(product => {\n        selectedQuantities.value[product.product_id] = 1;\n      });\n    });\n    return {\n      products: productStore.products,\n      selectedQuantities,\n      addToCart,\n      availableQuantity,\n      getQuantityInCart\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","useProductStore","useCartStore","setup","productStore","cartStore","selectedQuantities","addToCart","product","quantity","product_id","console","log","cart","value","availableQuantity","productInCart","find","item","quantityInCart","selectedQuantity","Array","from","length","stock","_","i","getQuantityInCart","productId","fetchProducts","products","forEach"],"sources":["/Users/kitakanta/Desktop/comvace関係/comvace6_1/src/views/InputView.vue"],"sourcesContent":["<template>\n  <div>\n    <h1>商品一覧</h1>\n    <div class=\"product\" v-for=\"product in products\" :key=\"product.product_id\">\n      <div class=\"product-info\">\n        <h2>{{ product.product_name }}</h2>\n        <p>価格: ¥{{ product.price }}</p>\n        <p>在庫: {{ product.stock }}</p>\n        <label>\n          数量:\n          <select v-model=\"selectedQuantities[product.product_id]\">\n            <option v-for=\"num in availableQuantity(product)\" :key=\"num\">{{ num }}</option>\n          </select>\n        </label>\n        <p>カートに入れられた合計数: {{ getQuantityInCart(product.product_id) }}</p>\n      </div>\n      <button @click=\"addToCart(product, selectedQuantities[product.product_id])\">カートに追加</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport { useProductStore } from '@/store/product.js'\nimport { useCartStore } from '@/store/cart.js'\n\nexport default {\n  setup() {\n    const productStore = useProductStore()\n    const cartStore = useCartStore()\n    const selectedQuantities = ref({})\n\n    function addToCart(product, quantity) {\n      cartStore.addToCart(product.product_id, quantity)\n      console.log('Cart after adding product: ', cartStore.cart)\n      selectedQuantities.value[product.product_id] = 1 // カートに追加した後に初期値を設定\n    }\n\n    function availableQuantity(product) {\n      const productInCart = cartStore.cart.find((item) => item.product_id === product.product_id)\n      const quantityInCart = productInCart ? productInCart.selectedQuantity : 0 // selectedQuantity を使用する\n      return Array.from({ length: product.stock - quantityInCart }, (_, i) => i + 1)\n    }\n\n    function getQuantityInCart(productId) {\n      const productInCart = cartStore.cart.find((item) => item.product_id === productId)\n      return productInCart ? productInCart.selectedQuantity : 0\n    }\n\n    onMounted(async () => {\n      await productStore.fetchProducts()\n\n      productStore.products.forEach((product) => {\n        selectedQuantities.value[product.product_id] = 1\n      })\n    })\n\n    return {\n      products: productStore.products,\n      selectedQuantities,\n      addToCart,\n      availableQuantity,\n      getQuantityInCart,\n    }\n  },\n}\n</script>\n\n<style scoped></style>\n"],"mappings":"AAsBA,SAASA,GAAG,EAAEC,SAAQ,QAAS,KAAI;AACnC,SAASC,eAAc,QAAS,oBAAmB;AACnD,SAASC,YAAW,QAAS,iBAAgB;AAE7C,eAAe;EACbC,KAAKA,CAAA,EAAG;IACN,MAAMC,YAAW,GAAIH,eAAe,CAAC;IACrC,MAAMI,SAAQ,GAAIH,YAAY,CAAC;IAC/B,MAAMI,kBAAiB,GAAIP,GAAG,CAAC,CAAC,CAAC;IAEjC,SAASQ,SAASA,CAACC,OAAO,EAAEC,QAAQ,EAAE;MACpCJ,SAAS,CAACE,SAAS,CAACC,OAAO,CAACE,UAAU,EAAED,QAAQ;MAChDE,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEP,SAAS,CAACQ,IAAI;MACzDP,kBAAkB,CAACQ,KAAK,CAACN,OAAO,CAACE,UAAU,IAAI,GAAE;IACnD;;IAEA,SAASK,iBAAiBA,CAACP,OAAO,EAAE;MAClC,MAAMQ,aAAY,GAAIX,SAAS,CAACQ,IAAI,CAACI,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACR,UAAS,KAAMF,OAAO,CAACE,UAAU;MAC1F,MAAMS,cAAa,GAAIH,aAAY,GAAIA,aAAa,CAACI,gBAAe,GAAI,GAAE;MAC1E,OAAOC,KAAK,CAACC,IAAI,CAAC;QAAEC,MAAM,EAAEf,OAAO,CAACgB,KAAI,GAAIL;MAAe,CAAC,EAAE,CAACM,CAAC,EAAEC,CAAC,KAAKA,CAAA,GAAI,CAAC;IAC/E;IAEA,SAASC,iBAAiBA,CAACC,SAAS,EAAE;MACpC,MAAMZ,aAAY,GAAIX,SAAS,CAACQ,IAAI,CAACI,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACR,UAAS,KAAMkB,SAAS;MACjF,OAAOZ,aAAY,GAAIA,aAAa,CAACI,gBAAe,GAAI;IAC1D;IAEApB,SAAS,CAAC,YAAY;MACpB,MAAMI,YAAY,CAACyB,aAAa,CAAC;MAEjCzB,YAAY,CAAC0B,QAAQ,CAACC,OAAO,CAAEvB,OAAO,IAAK;QACzCF,kBAAkB,CAACQ,KAAK,CAACN,OAAO,CAACE,UAAU,IAAI;MACjD,CAAC;IACH,CAAC;IAED,OAAO;MACLoB,QAAQ,EAAE1B,YAAY,CAAC0B,QAAQ;MAC/BxB,kBAAkB;MAClBC,SAAS;MACTQ,iBAAiB;MACjBY;IACF;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}